<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>治疗师工作量报表</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "SimSun", "宋体", serif;
      font-size: 14px;
      line-height: 1.6;
      color: #000;
    }

    @page {
      size: A4 landscape;
      margin: 15mm 15mm 15mm 15mm;
    }

    .print-container {
      width: 297mm;
      height: 210mm;
      padding: 10mm;
      margin: 0 auto;
    }

    .print-header {
      text-align: center;
      margin-bottom: 20px;
      border-bottom: 2px solid #000;
      padding-bottom: 15px;
    }

    .print-header h1 {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .filter-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      padding: 15px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
    }

    .filter-item {
      display: flex;
      gap: 30px;
    }

    .info-item {
      display: flex;
    }

    .info-label {
      font-weight: bold;
      margin-right: 10px;
    }

    .summary-cards {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .summary-card {
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      text-align: center;
    }

    .summary-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
    }

    .summary-value {
      font-size: 24px;
      font-weight: bold;
      color: #409eff;
    }

    .report-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .report-table th,
    .report-table td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
    }

    .report-table th {
      background-color: #f0f0f0;
      font-weight: bold;
      font-size: 12px;
    }

    .report-table td {
      font-size: 12px;
    }

    .report-table td.left {
      text-align: left;
    }

    .rank-badge {
      display: inline-block;
      width: 24px;
      height: 24px;
      line-height: 24px;
      text-align: center;
      border-radius: 50%;
      font-weight: bold;
      font-size: 12px;
    }

    .rank-1 {
      background-color: #ffd700;
      color: #fff;
    }

    .rank-2 {
      background-color: #c0c0c0;
      color: #fff;
    }

    .rank-3 {
      background-color: #cd7f32;
      color: #fff;
    }

    .chart-placeholder {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    .chart-box {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      height: 250px;
    }

    .chart-title {
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 15px;
      text-align: center;
    }

    .simple-bar-chart {
      display: flex;
      align-items: flex-end;
      justify-content: space-around;
      height: 180px;
      padding: 20px 0;
    }

    .bar-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 60px;
    }

    .bar {
      width: 40px;
      background-color: #409eff;
      border-radius: 4px 4px 0 0;
      margin-bottom: 8px;
    }

    .bar-label {
      font-size: 11px;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 60px;
    }

    .bar-value {
      font-size: 11px;
      color: #666;
      margin-bottom: 4px;
    }

    .signature-section {
      display: flex;
      justify-content: space-between;
      margin-top: 50px;
      padding-top: 30px;
    }

    .signature-item {
      text-align: center;
      width: 200px;
    }

    .signature-line {
      border-bottom: 1px solid #000;
      height: 40px;
      margin-bottom: 10px;
    }

    .date-field {
      margin-top: 30px;
      text-align: right;
      padding-right: 50px;
    }

    @media print {
      .no-print {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="no-print" style="padding: 20px; text-align: center;">
    <button onclick="window.print()" style="padding: 10px 30px; font-size: 16px; cursor: pointer;">
      打印报表
    </button>
    <button onclick="window.close()" style="padding: 10px 30px; font-size: 16px; cursor: pointer; margin-left: 20px;">
      关闭
    </button>
  </div>

  <div class="print-container">
    <!-- 标题 -->
    <div class="print-header">
      <h1>虎林市中医医院康复科</h1>
      <h2>治疗师工作量统计报表</h2>
    </div>

    <!-- 筛选信息 -->
    <div class="filter-info">
      <div class="filter-item">
        <div class="info-item">
          <span class="info-label">统计时间:</span>
          <span>{{startDate}} 至 {{endDate}}</span>
        </div>
        <div class="info-item">
          <span class="info-label">打印时间:</span>
          <span>{{printTime}}</span>
        </div>
      </div>
    </div>

    <!-- 统计卡片 -->
    <div class="summary-cards">
      <div class="summary-card">
        <div class="summary-label">治疗总人次</div>
        <div class="summary-value">{{totalRecords}}</div>
      </div>
      <div class="summary-card">
        <div class="summary-label">总时长(小时)</div>
        <div class="summary-value">{{totalDuration}}</div>
      </div>
      <div class="summary-card">
        <div class="summary-label">治疗患者数</div>
        <div class="summary-value">{{totalPatients}}</div>
      </div>
      <div class="summary-card">
        <div class="summary-label">活跃治疗师</div>
        <div class="summary-value">{{activeTherapists}}</div>
      </div>
      <div class="summary-card">
        <div class="summary-label">涉及项目</div>
        <div class="summary-value">{{totalProjects}}</div>
      </div>
    </div>

    <!-- 治疗师工作量排名表 -->
    <h3 style="margin-bottom: 10px;">治疗师工作量排名</h3>

    <table class="report-table">
      <thead>
        <tr>
          <th style="width: 60px;">排名</th>
          <th style="width: 100px;">治疗师</th>
          <th style="width: 100px;">治疗人次</th>
          <th style="width: 100px;">时长(小时)</th>
          <th style="width: 100px;">患者数</th>
          <th>参与项目</th>
          <th style="width: 100px;">平均时长</th>
        </tr>
      </thead>
      <tbody>
        {{#each therapistStats}}
        <tr>
          <td>
            {{#if @index}}
            <span class="rank-badge rank-{{@index}}">{{@index}}</span>
            {{else}}
            <span class="rank-badge">{{@index}}</span>
            {{/if}}
          </td>
          <td class="left">{{therapistName}}</td>
          <td>{{count}}</td>
          <td>{{duration}}</td>
          <td>{{patientCount}}</td>
          <td class="left">{{projects}}</td>
          <td>{{avgDuration}}</td>
        </tr>
        {{/each}}
      </tbody>
    </table>

    <!-- 项目使用统计表 -->
    <h3 style="margin-bottom: 10px; margin-top: 20px;">项目使用统计</h3>

    <table class="report-table">
      <thead>
        <tr>
          <th style="width: 60px;">排名</th>
          <th>治疗项目</th>
          <th style="width: 100px;">使用次数</th>
          <th style="width: 100px;">占比</th>
          <th style="width: 120px;">总时长(小时)</th>
          <th style="width: 120px;">平均时长</th>
        </tr>
      </thead>
      <tbody>
        {{#each projectStats}}
        <tr>
          <td>{{@index}}</td>
          <td class="left">{{projectName}}</td>
          <td>{{count}}</td>
          <td>{{percentage}}%</td>
          <td>{{totalDuration}}</td>
          <td>{{avgDuration}}</td>
        </tr>
        {{/each}}
      </tbody>
    </table>

    <!-- 签名 -->
    <div class="signature-section">
      <div class="signature-item">
        <div class="signature-line"></div>
        <div>制表人签名</div>
      </div>
      <div class="signature-item">
        <div class="signature-line"></div>
        <div>康复科主任签名</div>
      </div>
      <div class="signature-item">
        <div class="signature-line"></div>
        <div>院长签名</div>
      </div>
    </div>

    <!-- 日期 -->
    <div class="date-field">
      打印日期: {{printDate}}
    </div>
  </div>

  <script>
    // 示例数据
    const data = {
      startDate: "2026-01-01",
      endDate: "2026-01-10",
      printTime: "2026-01-10 16:00",
      printDate: "2026年1月10日",
      totalRecords: 156,
      totalDuration: "234.5",
      totalPatients: 45,
      activeTherapists: 8,
      totalProjects: 7,
      therapistStats: [
        { therapistName: "王芳", count: 35, duration: "52.5", patientCount: 28, projects: "运动功能训练、生活技能康复训练", avgDuration: "90" },
        { therapistName: "刘强", count: 32, duration: "48.0", patientCount: 25, projects: "电刺激治疗、运动功能训练", avgDuration: "90" },
        { therapistName: "张明", count: 28, duration: "42.0", patientCount: 22, projects: "针灸治疗、认知功能训练", avgDuration: "90" },
        { therapistName: "李秀英", count: 25, duration: "37.5", patientCount: 20, projects: "电刺激治疗", avgDuration: "90" },
        { therapistName: "赵敏", count: 20, duration: "30.0", patientCount: 18, projects: "言语功能训练", avgDuration: "90" },
        { therapistName: "孙德明", count: 16, duration: "24.5", patientCount: 15, projects: "职业功能康复训练", avgDuration: "92" }
      ],
      projectStats: [
        { projectName: "运动功能训练", count: 45, percentage: "28.8", totalDuration: "67.5", avgDuration: "90" },
        { projectName: "电刺激治疗", count: 38, percentage: "24.4", totalDuration: "38.0", avgDuration: "60" },
        { projectName: "针灸治疗", count: 28, percentage: "17.9", totalDuration: "42.0", avgDuration: "90" },
        { projectName: "生活技能康复训练", count: 22, percentage: "14.1", totalDuration: "33.0", avgDuration: "90" },
        { projectName: "认知功能训练", count: 15, percentage: "9.6", totalDuration: "22.5", avgDuration: "90" },
        { projectName: "言语功能训练", count: 8, percentage: "5.1", totalDuration: "24.0", avgDuration: "180" }
      ]
    };
  </script>
</body>
</html>
